---
format: 
  html:
    default: false
    embed-resources: true
  markdown:
    default: true
editor:
    render-on-save: false
execute: 
  echo: false
  warning: false
  fig-width: 10
  fig-height: 5
---


```{r}
library(tidyverse)
library(glue)
library(ggthemes)
library(scales)
```


# Test

```{r}
num <- 125000
num_years <- 25
set.seed(44)


data <- tibble(growth = rnorm(num, 1.10, 0.2)) |>
    mutate(name = "Alice") |>
    mutate(simulation = ceiling(row_number() / num_years)) |>
    bind_rows(tibble(growth = rnorm(num, 1.04, 0.02)) |> mutate(name = "Bob") |>
        mutate(simulation = ceiling(row_number() / num_years)))

final_capital <- data |>
    group_by(name, simulation) |>
    summarise(total_growth = prod(growth)) |>
    ungroup()
```

```{r}

final_capital |>
    ggplot(aes(total_growth, fill = name)) +
    geom_histogram(bins = 100) +
    geom_vline(xintercept = 1, linetype = "dotted") +
    scale_x_continuous(trans = "log10", labels = percent) +
    scale_fill_tableau() +
    facet_wrap(~name) +
    theme_minimal()
```